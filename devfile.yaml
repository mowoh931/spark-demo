schemaVersion: 2.2.0
metadata:
  name: spring-boot-gradle-app
  version: 1.0.0
  description: Devfile for a Spring Boot application with Gradle and multi-stage Docker build

components:
  - name: tools-container
    container:
      image: gradle:8.9.0-jdk17-alpine
      memoryLimit: 2Gi
      cpuLimit: 1000m
      mountSources: true
      command: ["sleep"]
      args: ["infinity"]
      endpoints:
        - name: http
          targetPort: 8080

commands:
  - id: build
    exec:
      label: "Build the application"
      component: tools-container
      workingDir: /projects
      commandLine: "gradle build --no-daemon"

  - id: run
    exec:
      label: "Run the application"
      component: tools-container
      workingDir: /projects
      commandLine: "java -jar build/libs/*.jar"
      group:
        kind: run
        isDefault: true
