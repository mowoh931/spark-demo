schemaVersion: 2.2.0
metadata:
  name: java-app
  version: 1.0.0
  displayName: Java Spring Boot Application
  description: Java application for OpenShift deployment
  tags: ['java', 'spring', 'gradle']


components:
  - name: dev
    container:
      image: mowoh/spark-demo:latest
      memoryLimit: 2Gi
      mountSources: true
      sourceMapping: /project
      endpoints:
        - name: http-app
          targetPort: 8080
          exposure: public
      env:
        - name: JAVA_OPTS
          value: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75"

commands:
  - id: build
    exec:
      component: dev
      commandLine: './gradlew build --no-daemon'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: build
        isDefault: true

  - id: run
    exec:
      component: dev
      commandLine: 'java ${JAVA_OPTS} -jar build/libs/*.jar'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: run
        isDefault: true

  - id: test
    exec:
      component: dev
      commandLine: './gradlew test'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: test
